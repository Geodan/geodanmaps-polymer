<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-item/paper-item-body.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">

<dom-module id="gm-cow-userlist">
 <style>
 </style>
 <template>
 <paper-listbox>
 	<template is="dom-repeat" items="{{users}}">
 		<paper-item>
			<paper-item-body two-line>
				<div>{{item._data.name}}</div>
				<div secondary>{{updated(item)}}</div>
			</paper-item-body>
		</paper-item>
	</template>
 </paper-listbox>
 </template>
 
</dom-module>

<script>
Polymer({
	is: 'gm-cow-userlist',
	properties: {
		core: {
			type: Object,
			observer: '_coreChanged'
		}
	},
	_coreChanged: function(){
		var core = this.core;
		var self = this;
		core.userStore().loaded.then(function(){
			self.users = core.users().filter(d=>!d.deleted());
		});
		core.userStore().on('datachange', function(){
			self.users = core.users().filter(d=>!d.deleted());
		});
	},
	updated: function(d){
		return new Date(parseInt(d.updated())).toLocaleString();
	}
		
});
</script>